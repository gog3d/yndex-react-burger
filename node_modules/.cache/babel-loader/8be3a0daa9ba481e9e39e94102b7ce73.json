{"ast":null,"code":"var _jsxFileName = \"/home/gog3d/JS/6-yndex-react/0-project/react-burger/src/components/burger-constructor-button-container/burger-constructor-button-container.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useMemo, useCallback } from 'react';\nimport { useHistory } from \"react-router-dom\";\nimport styles from './burger-constructor-button-container.module.css';\nimport { CurrencyIcon, Button } from '@ya.praktikum/react-developer-burger-ui-components';\nimport Modal from '../modal/modal';\nimport OrderDetails from '../order-details/order-details';\nimport { getOrderDetails } from '../../redux/actions/ingredients';\nimport { useAppDispatch, useAppSelector } from '../../redux/hooks';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst BurgerConstructorButtonContainer = () => {\n  _s();\n\n  const {\n    orderDetailsItems,\n    orderDetails,\n    orderDetailsRequest,\n    orderDetailsFailed\n  } = useAppSelector(store => store.ingredients);\n  const {\n    authFailed\n  } = useAppSelector(store => store.auth);\n  const history = useHistory();\n  const constructorIngredients = useAppSelector(store => store.ingredients.constructorIngredients);\n  const dispatch = useAppDispatch();\n  const [open, setOpen] = useState(false);\n  const count = useMemo(() => {\n    const bunPrice = constructorIngredients.bun === null ? 0 : constructorIngredients.bun.price ? constructorIngredients.bun.price : 0;\n    const ingredientsPrice = constructorIngredients.ingredients.reduce((sum, comp) => sum + comp.price, 0);\n    return bunPrice + ingredientsPrice;\n  }, [constructorIngredients.ingredients, constructorIngredients.bun]);\n  const onClickButton = useCallback(() => {\n    if (orderDetailsItems !== null) {\n      if (orderDetailsItems.find(item => item.type === 'bun')) {\n        if (!authFailed) {\n          setOpen(true);\n          dispatch(getOrderDetails(orderDetailsItems));\n        } else {\n          history.push({\n            pathname: '/login'\n          });\n        }\n      }\n    }\n  }, [orderDetailsItems, authFailed]);\n  const orderDetailsStatus = useMemo(() => {\n    return orderDetailsFailed ? /*#__PURE__*/_jsxDEV(\"p\", {\n      className: styles.text,\n      children: \"\\u041F\\u0440\\u043E\\u0438\\u0437\\u043E\\u0448\\u043B\\u0430 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u043F\\u043E\\u043B\\u0443\\u0447\\u0435\\u043D\\u0438\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }, this) : orderDetailsRequest ? /*#__PURE__*/_jsxDEV(\"p\", {\n      className: styles.text,\n      children: \"...\\u0417\\u0430\\u043F\\u0440\\u043E\\u0441 \\u0434\\u0435\\u0442\\u0430\\u043B\\u0435\\u0439 \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }, this) : orderDetails ? '' : /*#__PURE__*/_jsxDEV(\"p\", {\n      className: styles.text,\n      children: \"\\u041F\\u0440\\u043E\\u0438\\u0437\\u043E\\u0448\\u043B\\u0430 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u043F\\u043E\\u043B\\u0443\\u0447\\u0435\\u043D\\u0438\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }, this);\n  }, [orderDetails, orderDetailsRequest, orderDetailsFailed]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    \"data-testid\": \"order_button\",\n    className: styles[\"burger-constructor-button-container\"],\n    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n      className: styles['burger-constructor-button-container-span'],\n      children: count\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CurrencyIcon, {\n      type: 'primary'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: open,\n      onClose: () => setOpen(false),\n      children: /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [orderDetailsStatus, !orderDetailsRequest && /*#__PURE__*/_jsxDEV(OrderDetails, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      onClick: () => onClickButton(),\n      children: \" \\u041E\\u0444\\u043E\\u0440\\u043C\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n};\n\n_s(BurgerConstructorButtonContainer, \"djYwD2hqmDhG3Ja0b5LRjfimDu0=\", false, function () {\n  return [useAppSelector, useAppSelector, useHistory, useAppSelector, useAppDispatch];\n});\n\n_c = BurgerConstructorButtonContainer;\nexport default BurgerConstructorButtonContainer;\n\nvar _c;\n\n$RefreshReg$(_c, \"BurgerConstructorButtonContainer\");","map":{"version":3,"names":["React","useState","useMemo","useCallback","useHistory","styles","CurrencyIcon","Button","Modal","OrderDetails","getOrderDetails","useAppDispatch","useAppSelector","BurgerConstructorButtonContainer","orderDetailsItems","orderDetails","orderDetailsRequest","orderDetailsFailed","store","ingredients","authFailed","auth","history","constructorIngredients","dispatch","open","setOpen","count","bunPrice","bun","price","ingredientsPrice","reduce","sum","comp","onClickButton","find","item","type","push","pathname","orderDetailsStatus","text"],"sources":["/home/gog3d/JS/6-yndex-react/0-project/react-burger/src/components/burger-constructor-button-container/burger-constructor-button-container.tsx"],"sourcesContent":["import React, { useState, useMemo, useCallback } from 'react';\nimport {\n  BrowserRouter as Router,\n  useHistory,\n} from \"react-router-dom\";\n\nimport styles from './burger-constructor-button-container.module.css';\nimport { CurrencyIcon, Button } from '@ya.praktikum/react-developer-burger-ui-components';\n\nimport Modal from '../modal/modal';\nimport OrderDetails from '../order-details/order-details';\nimport { getOrderDetails } from '../../redux/actions/ingredients';\nimport { RootState }  from '../../redux/store';\nimport { TIngredient } from '../../types/data';\n\nimport { useAppDispatch, useAppSelector } from '../../redux/hooks';\n\ndeclare module 'react' {\n  interface FunctionComponent<P = {}> {\n    (props: PropsWithChildren<P>, context?: any): ReactElement<any, any> | null;\n  }\n}\n\nconst BurgerConstructorButtonContainer: React.FC = () => {\n  const { \n    orderDetailsItems, \n    orderDetails,\n    orderDetailsRequest,\n    orderDetailsFailed,\n    } = useAppSelector((store) => store.ingredients);\n\n  const {\n    authFailed,\n  } = useAppSelector((store) => store.auth);\n\n  const history = useHistory();\n\n  const constructorIngredients = useAppSelector((store) => store.ingredients.constructorIngredients);\n  \n  const dispatch = useAppDispatch();\n  const [open, setOpen] = useState(false);\n\n  const count = useMemo(\n    () => {\n      const bunPrice = constructorIngredients.bun === null ? 0 : constructorIngredients.bun.price ? constructorIngredients.bun.price : 0;\n      const ingredientsPrice = constructorIngredients.ingredients.reduce((sum, comp) => sum + comp.price, 0);\n      return bunPrice + ingredientsPrice;\n    }, [constructorIngredients.ingredients, constructorIngredients.bun]\n  );\n  \n  const onClickButton = useCallback(() => {\n    if(orderDetailsItems !== null) {\n      if (orderDetailsItems.find((item: TIngredient ) => item.type === 'bun')) {\n        if(!authFailed) {\n          setOpen(true);\n          dispatch(getOrderDetails(orderDetailsItems));\n        } else {\n          history.push({\n            pathname: '/login',\n          });\n        }\n      }\n    }\n  }, [orderDetailsItems, authFailed]);\n  \n  const orderDetailsStatus = useMemo(\n    () => {\n      return orderDetailsFailed ? (\n        <p className={styles.text}>Произошла ошибка при получении данных</p>\n      ) : orderDetailsRequest ? (\n        <p className={styles.text}>...Запрос деталей заказа</p>\n      ) : orderDetails ? (\n       ''\n      ) : (\n        <p className={styles.text}>Произошла ошибка при получении данных</p>\n      );\n    },\n    [orderDetails, orderDetailsRequest, orderDetailsFailed]\n  );\n\n  return (\n    <div data-testid='order_button' className={styles[\"burger-constructor-button-container\"]} >\n      <span className={styles['burger-constructor-button-container-span']}>\n        {count}\n      </span>\n      <CurrencyIcon type={'primary'} />\n      <Modal\n        isOpen={open}\n        onClose={()=>setOpen(false)}\n      >\n        <>\n          {orderDetailsStatus}\n          {\n            !orderDetailsRequest && \n            <OrderDetails/>\n          }\n        </>\n      </Modal>\n      <Button \n        onClick={()=> onClickButton()}\n      > Оформить заказ</Button>\n    </div>\n  );\n}\n\nexport default BurgerConstructorButtonContainer;"],"mappings":"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"},"metadata":{},"sourceType":"module"}