{"ast":null,"code":"var _jsxFileName = \"/home/gog3d/JS/6-yndex-react/0-project/react-burger/src/components/burger-constructor-list-component/burger-constructor-list-component.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useCallback, useRef } from 'react';\nimport styles from './burger-constructor-list-component.module.css';\nimport { DragIcon, ConstructorElement } from '@ya.praktikum/react-developer-burger-ui-components';\nimport { useDrop, useDrag } from 'react-dnd';\nimport { deleteConstructorIngredient, updateConstructorIngredients } from '../../redux/actions/ingredients';\nimport { useAppDispatch, useAppSelector } from '../../redux/hooks';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n;\n\nconst BurgerConstructorListComponent = props => {\n  _s();\n\n  const dispatch = useAppDispatch();\n  const {\n    item,\n    index\n  } = props;\n  const ingredients = useAppSelector(store => store.ingredients.constructorIngredients.ingredients);\n  const [locked, setIsLocked] = useState(false);\n\n  const onClickBurgerConstructorListComponent = () => {\n    dispatch(deleteConstructorIngredient(index));\n  };\n\n  const moveIngredients = useCallback((dragIndex, hoverIndex) => {\n    const dragItem = ingredients[dragIndex];\n    const hoverItem = ingredients[hoverIndex];\n    const updatedIngredients = [...ingredients];\n    updatedIngredients[dragIndex] = hoverItem;\n    updatedIngredients[hoverIndex] = dragItem;\n    dispatch(updateConstructorIngredients(updatedIngredients));\n  }, [ingredients]);\n  const [{\n    isDragging\n  }, dragRef] = useDrag({\n    type: 'item',\n    item: {\n      index\n    },\n    collect: monitor => ({\n      isDragging: monitor.isDragging()\n    })\n  });\n  const [, dropRef] = useDrop({\n    accept: 'item',\n    hover: (item, monitor) => {\n      var _ref$current;\n\n      if (!ref.current) return;\n      const dragIndex = item.index;\n      const hoverIndex = index;\n      const hoverBoundingRect = (_ref$current = ref.current) === null || _ref$current === void 0 ? void 0 : _ref$current.getBoundingClientRect();\n      const hoverMiddleY = (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2;\n      const clientOffset = monitor.getClientOffset();\n      if (clientOffset === null) return;\n      const hoverActualY = clientOffset.y - hoverBoundingRect.top;\n      if (dragIndex < hoverIndex && hoverActualY < hoverMiddleY) return;\n      if (dragIndex > hoverIndex && hoverActualY > hoverMiddleY) return;\n      moveIngredients(dragIndex, hoverIndex);\n      item.index = hoverIndex;\n    }\n  });\n  const ref = useRef(null);\n  const dragDropRef = dragRef(dropRef(ref));\n  const opacity = isDragging ? 0 : 1;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: ref,\n    className: styles[\"burger-constructor-list-component\"],\n    style: {\n      opacity\n    },\n    children: [/*#__PURE__*/_jsxDEV(DragIcon, {\n      type: \"primary\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ConstructorElement, {\n      handleClose: onClickBurgerConstructorListComponent,\n      isLocked: locked,\n      text: item.name,\n      price: item.price,\n      thumbnail: item.image\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 11\n  }, this);\n};\n\n_s(BurgerConstructorListComponent, \"qkb5OEC+uxGEwLKBse4E5QLZgys=\", false, function () {\n  return [useAppDispatch, useAppSelector, useDrag, useDrop];\n});\n\n_c = BurgerConstructorListComponent;\nexport default BurgerConstructorListComponent;\n\nvar _c;\n\n$RefreshReg$(_c, \"BurgerConstructorListComponent\");","map":{"version":3,"names":["React","useState","useCallback","useRef","styles","DragIcon","ConstructorElement","useDrop","useDrag","deleteConstructorIngredient","updateConstructorIngredients","useAppDispatch","useAppSelector","BurgerConstructorListComponent","props","dispatch","item","index","ingredients","store","constructorIngredients","locked","setIsLocked","onClickBurgerConstructorListComponent","moveIngredients","dragIndex","hoverIndex","dragItem","hoverItem","updatedIngredients","isDragging","dragRef","type","collect","monitor","dropRef","accept","hover","ref","current","hoverBoundingRect","getBoundingClientRect","hoverMiddleY","bottom","top","clientOffset","getClientOffset","hoverActualY","y","dragDropRef","opacity","name","price","image"],"sources":["/home/gog3d/JS/6-yndex-react/0-project/react-burger/src/components/burger-constructor-list-component/burger-constructor-list-component.tsx"],"sourcesContent":["import React, { useState, useCallback, useRef } from 'react';\nimport styles from './burger-constructor-list-component.module.css';\nimport { DragIcon, ConstructorElement } from '@ya.praktikum/react-developer-burger-ui-components';\nimport { useDrop, useDrag } from 'react-dnd';\nimport {\n \n  deleteConstructorIngredient,\n  updateConstructorIngredients,\n \n} from '../../redux/actions/ingredients';\n\nimport { TIngredient } from '../../types/data';\nimport { useAppDispatch, useAppSelector } from '../../redux/hooks';\n\ninterface BurgerConstructorListComponentProps {\n  item: TIngredient,\n  index: number,\n};\n\nconst BurgerConstructorListComponent: React.FC<BurgerConstructorListComponentProps> = (props) => {\n  const dispatch = useAppDispatch();\n  const { item, index } = props;\n\n  const ingredients = useAppSelector((store) => store.ingredients.constructorIngredients.ingredients);\n\n  const [locked, setIsLocked] =useState(false);\n\n  const onClickBurgerConstructorListComponent = () => {\n    dispatch(deleteConstructorIngredient(index));\n  };\n\n  const moveIngredients = useCallback(\n      (dragIndex: number, hoverIndex: number) => {\n      const dragItem = ingredients[dragIndex];\n      const hoverItem = ingredients[hoverIndex];\n      const updatedIngredients = [...ingredients];\n      updatedIngredients[dragIndex] = hoverItem;\n      updatedIngredients[hoverIndex] = dragItem;\n      dispatch(updateConstructorIngredients(updatedIngredients));\n    },\n    [ingredients]\n  )\n\n  const [{ isDragging }, dragRef] = useDrag({\n    type: 'item',\n    item: { index },\n    collect: (monitor) => ({\n      isDragging: monitor.isDragging(),\n    }),\n  });\n\n  const [, dropRef] = useDrop({\n    accept: 'item',\n    hover: (item: {index: number}, monitor) => {\n      if(!ref.current) return;\n      const dragIndex = item.index;\n      const hoverIndex = index;\n      const hoverBoundingRect = ref.current?.getBoundingClientRect();\n      const hoverMiddleY = (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2;\n      const clientOffset = monitor.getClientOffset();\n      if (clientOffset === null) return; \n      const hoverActualY = clientOffset.y - hoverBoundingRect.top;\n      if (dragIndex < hoverIndex && hoverActualY < hoverMiddleY) return;\n      if (dragIndex > hoverIndex && hoverActualY > hoverMiddleY) return;\n      moveIngredients(dragIndex, hoverIndex);\n      item.index = hoverIndex;\n    },\n  })\n\n  const ref = useRef<HTMLDivElement>(null)\n  const dragDropRef = dragRef(dropRef(ref))\n  const opacity = isDragging ? 0 : 1\n\n  return (\n          <div \n            ref={ref} \n            className={styles[\"burger-constructor-list-component\"]} \n            style={{opacity}} \n            >\n            <DragIcon type='primary' />\n            <ConstructorElement\n              handleClose={onClickBurgerConstructorListComponent}\n              isLocked={locked}\n              text={item.name}\n              price={item.price}\n              thumbnail={item.image}\n            />\n          </div>\n  );\n}\n\nexport default BurgerConstructorListComponent;"],"mappings":"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"},"metadata":{},"sourceType":"module"}